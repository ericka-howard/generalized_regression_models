---
title: "Problem 1"
author: "Ericka Smith"
date: "11/4/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(magrittr)
```

Load and manipulate data

```{r}
birth <- read.table("C:/Users/erick/Downloads/birth.txt", quote="\"", stringsAsFactors=TRUE)
# fix column names
names(birth) <- c("family_size", "birth_order", "MM", "MF", "FM", "FF")
# make sex sequence a variable
birth_long <- birth %>% pivot_longer(c("MM", "MF", "FM", "FF"), names_to = "sex_seq", values_to = "response")
```

## Part A

#### i)

```{r}
modi <- lm(response~family_size + birth_order + sex_seq, data=birth_long)
deviance(modi)
```

#### ii)

First create a dataset with birth order reversed.

```{r}
birth_reversed <- birth_long %>%
  mutate(birth_order = recode(birth_order, 
                              "1-2" = "2-1",
                              "2-3" = "3-2",
                              "3-4" = "4-3",
                              "4-5" = "5-4",
                              "5-6" = "6-5"),
         sex_seq = recode(sex_seq,
                          "MF" = "FM",
                          "FM" = "MF"))
```

Now find the residual sum of squares.

```{r}
modii <- lm(response~family_size + birth_order + sex_seq, data=birth_reversed)
deviance(modii)
```

#### iii)

```{r}
modiii <- lm(response~family_size*birth_order + sex_seq, data=birth_long)
deviance(modiii)
```

#### iv)

```{r}
modiv <- lm(response~family_size*birth_order + sex_seq, data=birth_reversed)
deviance(modiv)
```

## Part B

```{r}
summary(modi)
summary(modii)
```

These models are the same except for the interpretation of them. The sex sequence is not significant in either model, only the birth order is. Since the birth order has the same levels just with different titles, this makes sense. For the second model you would talk about the distance in time from the second child to the first child. In the second model you'd talk about the distance in teim from the first child to the second child. These are the same values. 

## Part C

```{r}
summary(modi)
logmodi <- lm(log(response)~family_size + birth_order + sex_seq, data=birth_long)
summary(logmodi)
# summary(modii)
# logmodiii <- lm(log(response)~family_size*birth_order + sex_seq, data=birth_reversed)
# summary(logmodiii)
```

I don't notice anything particularly unusual. I tried a transformation and found that transforming the response variable results in a higher adjusted R-squared and a higher F-statistic. The untransformed model is still a good fit but the transformed one is better.

## Part D

This data is really interesting for a few reasons. First, that the sex sequence doesn't have any significant effect on the mean interval in months between successive births in the same family. Family size and birth order however are both significant ($\alpha=0.05$). As family size increases we see a decrease in mean interval between successive births. Conversely, it seems that there is a greater time duration between later birth orders (i.e. 5-6) as compared to earlier birth orders (i.e. 2-3).
